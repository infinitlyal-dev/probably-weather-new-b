<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TaxBuddy - Take control of your tax</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <div id="app">

    <!-- ==================== WELCOME SCREEN ==================== -->
    <section class="screen active" id="welcome" data-testid="welcome">
      <div class="welcome-content">
        <div class="welcome-icon">ğŸŒ¿</div>
        <h1>Let's get your tax tracking sorted</h1>
        <p class="welcome-subtitle">This takes about 2 minutes. We'll ask a few questions to set up TaxBuddy just for you.</p>

        <div class="confidence-badge">
          <span>âœ¨</span> Join thousands of South Africans taking control of their tax
        </div>

        <button class="btn btn-primary btn-large" id="welcome-start-btn" data-testid="welcome-start-btn">
          Let's do this â†’
        </button>

        <a href="#" class="quick-setup-link" id="welcome-quick-setup" data-testid="welcome-quick-setup">
          Short on time? Quick setup with recommended settings
        </a>
      </div>
    </section>

    <!-- ==================== WIZARD CONTAINER ==================== -->
    <div class="wizard-container" id="wizard-container">

      <!-- Progress Bar -->
      <div class="progress-wrapper">
        <div class="progress-text" id="progress-text">Step 1 of 4</div>
        <div class="progress-track">
          <div class="progress-fill" id="progress-fill"></div>
        </div>
        <div class="progress-dots">
          <button class="progress-dot active" data-step="1" data-testid="progress-dot-1">1</button>
          <button class="progress-dot" data-step="2" data-testid="progress-dot-2">2</button>
          <button class="progress-dot" data-step="3" data-testid="progress-dot-3">3</button>
          <button class="progress-dot" data-step="4" data-testid="progress-dot-4">4</button>
        </div>
      </div>

      <!-- ==================== STEP 1: INCOME TYPE ==================== -->
      <section class="screen step" id="step-1" data-testid="step-1">
        <div class="step-content">
          <h2>How do you earn your income?</h2>
          <p class="step-helper">This helps us show you the right expense categories and estimate your deductions.</p>

          <div class="tip-box">
            <span class="tip-icon">ğŸ’¡</span>
            <div>
              <strong>Why this matters:</strong> Freelancers and business owners can claim WAY more deductions than employees. We'll show you exactly what applies to you.
            </div>
          </div>

          <div class="option-cards" id="income-type-cards">
            <label class="option-card" data-testid="income-type-employee">
              <input type="radio" name="incomeType" value="employee">
              <span class="card-icon">ğŸ’¼</span>
              <span class="card-content">
                <span class="card-title">Employee</span>
                <span class="card-desc">I receive a salary from an employer</span>
              </span>
              <span class="card-check">âœ“</span>
            </label>

            <label class="option-card" data-testid="income-type-freelancer">
              <input type="radio" name="incomeType" value="freelancer">
              <span class="card-icon">ğŸ¨</span>
              <span class="card-content">
                <span class="card-title">Freelancer</span>
                <span class="card-desc">I work for myself with various clients</span>
              </span>
              <span class="card-check">âœ“</span>
            </label>

            <label class="option-card" data-testid="income-type-business">
              <input type="radio" name="incomeType" value="business">
              <span class="card-icon">ğŸ¢</span>
              <span class="card-content">
                <span class="card-title">Business Owner</span>
                <span class="card-desc">I run my own registered business</span>
              </span>
              <span class="card-check">âœ“</span>
            </label>

            <label class="option-card" data-testid="income-type-mixed">
              <input type="radio" name="incomeType" value="mixed">
              <span class="card-icon">ğŸ”€</span>
              <span class="card-content">
                <span class="card-title">Mixed Income</span>
                <span class="card-desc">I have salary plus side income</span>
              </span>
              <span class="card-check">âœ“</span>
            </label>
          </div>

          <div class="error-message" id="income-type-error"></div>

          <!-- Provisional Tax (reveals after selection) -->
          <div class="conditional-section" id="provisional-section">
            <div class="section-divider">
              <span>One more thing...</span>
            </div>

            <div class="form-group">
              <label class="form-label">Do you pay provisional tax?</label>
              <div class="pill-group" id="provisional-tax-pills">
                <label class="pill" data-testid="provisional-tax-yes">
                  <input type="radio" name="provisionalTax" value="yes">
                  <span>Yes</span>
                </label>
                <label class="pill" data-testid="provisional-tax-no">
                  <input type="radio" name="provisionalTax" value="no">
                  <span>No</span>
                </label>
                <label class="pill" data-testid="provisional-tax-not_sure">
                  <input type="radio" name="provisionalTax" value="not_sure">
                  <span>Not sure</span>
                </label>
              </div>
            </div>

            <div class="explainer-accordion" id="provisional-explainer">
              <div class="explainer-content">
                <p>ğŸ’¡ <strong>Provisional tax</strong> is money you pay to SARS in advance if you earn income that isn't taxed by an employer â€” like freelance gigs, rental income, or business profits.</p>
                <p>If you're only an employee with no side income, the answer is usually <strong>"No"</strong>.</p>
                <p>Not sure? Just pick "No" for now â€” you can always change this later in settings.</p>
              </div>
            </div>
          </div>
        </div>

        <div class="step-nav">
          <div></div>
          <button class="btn btn-primary" id="step1-continue" data-testid="continue-btn" disabled>
            Continue â†’
          </button>
        </div>
      </section>

      <!-- ==================== STEP 2: INCOME DETAILS ==================== -->
      <section class="screen step" id="step-2" data-testid="step-2">
        <div class="step-content">
          <h2>Tell us a bit about your income</h2>
          <p class="step-helper">This helps us estimate your potential tax savings. We never share your data with anyone.</p>

          <div class="tip-box">
            <span class="tip-icon">ğŸ’¡</span>
            <div>
              <strong>Did you know?</strong> If you earn over R95,750 per year, you're already in a tax bracket where tracking deductions really pays off.
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">How often do you get paid?</label>
            <div class="segment-group" id="cadence-segment">
              <button type="button" class="segment active" data-value="monthly" data-testid="cadence-monthly">Monthly</button>
              <button type="button" class="segment" data-value="weekly" data-testid="cadence-weekly">Weekly</button>
              <button type="button" class="segment" data-value="varies" data-testid="cadence-varies">It varies</button>
            </div>
            <p class="field-helper" id="cadence-helper"></p>
          </div>

          <div class="form-group">
            <label class="form-label">
              What's your typical monthly income?
              <span class="optional-badge">Optional</span>
            </label>
            <div class="input-with-prefix">
              <span class="input-prefix">R</span>
              <input type="number" id="monthly-income" placeholder="e.g. 25,000" min="0" data-testid="monthly-income">
            </div>
            <p class="field-helper">A rough estimate is fine. This helps us calculate potential savings.</p>
          </div>

          <div class="form-group">
            <label class="toggle-row">
              <span class="toggle-content">
                <span class="toggle-label">My income varies month to month</span>
                <span class="toggle-helper" id="income-varies-helper"></span>
              </span>
              <input type="checkbox" id="income-varies" class="toggle-input" data-testid="income-varies">
              <span class="toggle-switch"></span>
            </label>
          </div>

          <div class="form-group">
            <label class="toggle-row">
              <span class="toggle-content">
                <span class="toggle-label">Show me savings estimates</span>
              </span>
              <input type="checkbox" id="wants-estimate" class="toggle-input" checked data-testid="wants-estimate">
              <span class="toggle-switch"></span>
            </label>
          </div>

          <div class="conditional-section" id="estimate-detail-section">
            <label class="form-label">How detailed should estimates be?</label>
            <div class="small-cards" id="estimate-detail-cards">
              <label class="small-card selected" data-testid="estimate-simple">
                <input type="radio" name="estimateDetail" value="simple" checked>
                <span class="small-card-icon">ğŸ“Š</span>
                <span class="small-card-title">Simple</span>
                <span class="small-card-desc">Yearly estimate</span>
              </label>
              <label class="small-card" data-testid="estimate-detailed">
                <input type="radio" name="estimateDetail" value="detailed">
                <span class="small-card-icon">ğŸ“ˆ</span>
                <span class="small-card-title">Detailed</span>
                <span class="small-card-desc">Monthly breakdown</span>
              </label>
            </div>
          </div>

          <div class="info-callout">
            <span class="callout-icon">ğŸ“…</span>
            <span>Just so you know: South Africa's tax year runs from 1 March to 28 February â€” not January to December.</span>
          </div>
        </div>

        <div class="step-nav">
          <button class="btn btn-text" id="step2-back" data-testid="back-btn">â† Back</button>
          <button class="btn btn-primary" id="step2-continue" data-testid="continue-btn">Continue â†’</button>
        </div>
      </section>

      <!-- ==================== STEP 3: CATEGORIES ==================== -->
      <section class="screen step" id="step-3" data-testid="step-3">
        <div class="step-content">
          <h2>What expenses do you want to track?</h2>
          <p class="step-helper">We've recommended categories based on your income type. These are all SARS-approved deductions â€” money that could come back to you.</p>

          <div class="tip-box">
            <span class="tip-icon">ğŸ’¡</span>
            <div>
              <strong>Real talk:</strong> Most South Africans leave money on the table because they don't know what counts as a deduction. Let's fix that.
            </div>
          </div>

          <button class="btn btn-outline use-recommended" id="use-recommended-btn" data-testid="use-recommended-btn">
            âœ¨ Use recommended for me
          </button>

          <div class="category-list" id="category-list">
            <!-- Categories rendered by JS -->
          </div>

          <div class="error-message" id="category-error"></div>

          <div class="motivational-callout" id="motivational-callout">
            <!-- Rendered by JS -->
          </div>
        </div>

        <div class="step-nav">
          <button class="btn btn-text" id="step3-back" data-testid="back-btn">â† Back</button>
          <button class="btn btn-primary" id="step3-continue" data-testid="continue-btn">Continue â†’</button>
        </div>
      </section>

      <!-- ==================== STEP 4: PREFERENCES ==================== -->
      <section class="screen step" id="step-4" data-testid="step-4">
        <div class="step-content">
          <h2>How do you want to track expenses?</h2>
          <p class="step-helper">Good habits = stress-free tax season. Let's set you up for success.</p>

          <div class="tip-box">
            <span class="tip-icon">ğŸ’¡</span>
            <div>
              <strong>The secret to stress-free tax season?</strong> Logging expenses as they happen. Even a quick photo of a receipt counts.
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">When will you capture expenses?</label>
            <div class="option-cards compact" id="capture-mode-cards">
              <label class="option-card" data-testid="capture-mode-as_i_go">
                <input type="radio" name="captureMode" value="as_i_go" checked>
                <span class="card-icon">ğŸ“±</span>
                <span class="card-content">
                  <span class="card-title">As I spend</span>
                  <span class="card-desc">Log expenses right after paying</span>
                  <span class="card-extra">Best for accurate tracking</span>
                </span>
                <span class="card-check">âœ“</span>
              </label>

              <label class="option-card" data-testid="capture-mode-monthly">
                <input type="radio" name="captureMode" value="monthly">
                <span class="card-icon">ğŸ“…</span>
                <span class="card-content">
                  <span class="card-title">Monthly batch</span>
                  <span class="card-desc">Add everything at month-end</span>
                  <span class="card-extra">Set aside 30 mins once a month</span>
                </span>
                <span class="card-check">âœ“</span>
              </label>

              <label class="option-card" data-testid="capture-mode-both">
                <input type="radio" name="captureMode" value="both">
                <span class="card-icon">ğŸ”„</span>
                <span class="card-content">
                  <span class="card-title">Mix of both</span>
                  <span class="card-desc">Capture some now, batch the rest</span>
                </span>
                <span class="card-check">âœ“</span>
              </label>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Set up a monthly reminder</label>
            <p class="field-helper" style="margin-top: -8px; margin-bottom: 16px;">We'll nudge you to review and add any missing expenses</p>

            <div class="reminder-grid">
              <div class="form-group">
                <label class="form-label-small">Day of the month</label>
                <div class="number-input-wrapper">
                  <button type="button" class="number-btn minus" data-target="reminder-day">âˆ’</button>
                  <input type="number" id="reminder-day" value="25" min="1" max="28" data-testid="reminder-day">
                  <button type="button" class="number-btn plus" data-target="reminder-day">+</button>
                </div>
                <p class="field-helper">Most people pick a few days before month-end</p>
              </div>

              <div class="form-group">
                <label class="form-label-small">What time works?</label>
                <div class="segment-group small" id="reminder-pref-segment">
                  <button type="button" class="segment" data-value="morning" data-testid="reminder-morning">â˜€ï¸ Morning</button>
                  <button type="button" class="segment active" data-value="evening" data-testid="reminder-evening">ğŸŒ™ Evening</button>
                </div>
              </div>

              <div class="form-group">
                <label class="form-label-small">Time</label>
                <select id="reminder-time" class="select-input" data-testid="reminder-time">
                  <!-- Populated by JS -->
                </select>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label class="toggle-row">
              <span class="toggle-content">
                <span class="toggle-label">I have an accountant or tax practitioner</span>
              </span>
              <input type="checkbox" id="has-practitioner" class="toggle-input" data-testid="has-practitioner">
              <span class="toggle-switch"></span>
            </label>
          </div>

          <div class="conditional-section" id="practitioner-section">
            <div class="form-group">
              <label class="form-label">Their email <span class="optional-badge">Optional</span></label>
              <input type="email" id="practitioner-email" class="text-input" placeholder="accountant@example.com" data-testid="practitioner-email">
              <p class="field-helper">We'll format your exports to make their life easier.</p>
            </div>
          </div>

          <div class="security-note">
            <span>ğŸ”’</span> Your data stays on your device. We don't share anything with SARS or anyone else.
          </div>
        </div>

        <div class="step-nav">
          <button class="btn btn-text" id="step4-back" data-testid="back-btn">â† Back</button>
          <button class="btn btn-primary btn-large" id="step4-continue" data-testid="continue-btn">Complete Setup â†’</button>
        </div>
      </section>

    </div>

    <!-- ==================== COMPLETION SCREEN ==================== -->
    <section class="screen" id="completion" data-testid="completion">
      <div class="completion-content">
        <div class="confetti" id="confetti"></div>

        <div class="completion-icon">ğŸ‰</div>

        <h1>You're ready for tax season ğŸ’ª</h1>

        <p class="completion-subtitle">
          Most South Africans scramble for receipts in February. Not you.<br>
          Everything you track from now on is organised, totalled, and ready.
        </p>

        <div class="vision-quote">
          <p>Picture this: It's February. Tax season arrives. But instead of panic, you open TaxBuddy and everything is there â€” organised, categorised, ready to send to SARS or your tax practitioner.</p>
          <p><strong>That's what you just set up.</strong></p>
        </div>

        <div class="summary-card" id="summary-card">
          <div class="summary-header">âœ“ Your TaxBuddy Profile</div>
          <div class="summary-items" id="summary-items">
            <!-- Rendered by JS -->
          </div>
          <div class="summary-footer">
            "Every receipt you log is potential money back."
          </div>
        </div>

        <div class="first-action">
          <span class="first-action-icon">ğŸ’¡</span>
          <span><strong>Your first win:</strong> Log an expense within 24 hours. It takes 30 seconds and builds the habit.</span>
        </div>

        <div class="completion-actions">
          <button class="btn btn-primary btn-large" id="add-expense-btn" data-testid="completion-add-expense-btn">
            Add my first expense â†’
          </button>
          <a href="#" class="dashboard-link" id="dashboard-btn" data-testid="completion-dashboard-btn">
            Go to Dashboard
          </a>
        </div>

        <p class="legal-footer">
          TaxBuddy helps you organise and understand your tax records. We don't submit to SARS or give tax advice â€” but we'll make sure you're ready when the time comes.
        </p>
      </div>
    </section>

    <!-- ==================== APP SCREENS ==================== -->

    <!-- Dashboard Screen -->
    <section class="screen" id="app-dashboard">
      <!-- Content rendered by JS -->
    </section>

    <!-- Expenses List Screen -->
    <section class="screen" id="app-expenses">
      <!-- Content rendered by JS -->
    </section>

    <!-- Add/Edit Expense Form Screen -->
    <section class="screen" id="app-expense-form">
      <!-- Content rendered by JS -->
    </section>

    <!-- Settings Screen -->
    <section class="screen" id="app-settings">
      <div class="settings-page">
        <div class="app-header">
          <h1>Settings</h1>
        </div>
        <div class="settings-content">
          <div class="settings-section">
            <h3>Profile</h3>
            <p class="settings-info">Your income type and preferences are set. Changes coming soon.</p>
          </div>
          <div class="settings-section">
            <h3>Data</h3>
            <button class="btn btn-outline btn-danger-outline" onclick="if(confirm('Reset all data? This cannot be undone.')) TaxBuddyApp.reset()">
              Reset All Data
            </button>
          </div>
          <div class="settings-section">
            <h3>About</h3>
            <p class="settings-info">TaxBuddy helps South Africans track tax-deductible expenses. Your data stays on your device.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Bottom Navigation -->
    <nav id="bottom-nav" class="bottom-nav" style="display: none;">
      <a href="#dashboard" class="nav-item active" data-screen="dashboard">
        <span class="nav-icon">ğŸ </span>
        <span class="nav-label">Home</span>
      </a>
      <a href="#add-expense" class="nav-item" data-screen="add-expense">
        <span class="nav-icon nav-icon-add">â•</span>
        <span class="nav-label">Add</span>
      </a>
      <a href="#expenses" class="nav-item" data-screen="expenses">
        <span class="nav-icon">ğŸ“‹</span>
        <span class="nav-label">Expenses</span>
      </a>
      <a href="#settings" class="nav-item" data-screen="settings">
        <span class="nav-icon">âš™ï¸</span>
        <span class="nav-label">Settings</span>
      </a>
    </nav>

  </div>

  <script src="js/db.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
